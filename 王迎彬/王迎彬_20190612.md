基于LINUX的C++（6）

1.指针

（1）数据对象的地址与值：地址与值是辩证统一的关系

地址：数据对象的存储位置在计算机中的编号

值：在该位置处存储的内容

（2）指针变量的定义与使用

指针的定义格式

格式：目标数据对象类型 * 指针变量名称;

例一：定义 p 为指向整数的指针：int * p;

例二：定义 p 为指向结构体类型的指针：

struct POINT{ int x, y; };  POINT * p;

多个指针变量的定义

例三：int * p, * q;

例四：typedef int * PINT;  PINT p, q;

（3）指针变量的存储布局

指针数据对象（变量）与目标数据对象（变量）

仅定义指针变量，未初始化

例一：int * p;

定义指针变量，并使其指向某个目标变量

例二：int n = 10;  int * p = &n;

定义指针变量，并使其指向数组首元素

例三：int a[8] = {1, 2, 3, 4, 5, 6, 7, 8};  int * p = a;

（4）指针变量的赋值

指针变量可以像普通变量一样赋值

示例：int n = 10;  int * p = &n, * q;  q = p;

两个指针指向同一个目标数据对象

（5）取址操作符

取址操作符“&”

获取数据对象的地址，可将结果赋给指针变量。

示例：int n = 10;  int * p;  p = &n;  int * q;  q = p;

（6）引领操作符

引领操作符

获取指针所指向的目标数据对象

例一：int m, n = 10;  int * q = &n;  m = *q;

使得 m 为 10

例二（接上例）：*q = 1;

使得 n 为 1

（7）指针的意义与作用

作为函数通信的一种手段：使用指针作为函数参数，不仅可以提高参数传递效率，还可以将该参数作为函数输出集的一员，带回结果。

作为构造复杂数据结构的手段：使用指针构造数据对象之间的关联，形成复杂数据结构。

作为动态内存分配和管理的手段，在程序执行期间动态构造数据对象之间的关联。

作为执行特定程序代码的手段：使用指针指向特定代码段，执行未来才能实现的函数。

2.常量指针与指针常量

常量指针：指向常量的指针

性质：不能通过指针修改目标数据对象的值，但可以改变指针值，使其指向其他地方。

示例一：int n = 10;  const int * p = &n;

典型使用场合：作为函数参数，表示函数内部不能修改指针所指向的目标数据对象值。

示例二：void PrintObject( const int * p );

指针常量：指针指向的位置不可变化

性质：不可将指针指向其他地方，但可改变指针所指向的目标数据对象值。

示例三：int n = 10;  int * const p = &n;

指针常量和其他常量一样，必须在定义时初始化。

常量指针常量：指向常量的指针常量（指针的双重只读属性）

性质：指针值不可改变，指向的目标数据对象值也不可改变。

示例四：const int n = 10;  const int * const p = &n;

典型使用场合：主要作为函数参数使用

3.指针与函数返回值

指针类型可以作为函数返回值，函数内部返回某个数据对象的地址，调用函数后将返回值赋值给某个指针，特别说明：不能返回函数内部定义的局部变量地址。

程序示例

    int global = 0;
    int * ReturnPointer()
    {
    return &global;
    }
4.指针与复合数据类型

指针与数组：数据对象地址的计算、作为函数参数的指针与数组、指针与数组的可互换性、　多维数组参数的传递。

指针与结构体：指向结构体的指针、指针作为结构体类型的成员。

5.数据对象地址的计算

数组定义：int a[8] = {1, 2, 3, 4, 5, 6, 7, 8};

数组基地址：&a 或 a

数组元素地址：

数组首元素地址：&a[0]

数组第 i 元素地址：&a[0] + i * sizeof( int )

数组基地址与首元素地址数值相同，故数组第 i 元素地址：a + i * sizeof( int )

6.指针运算

希望表达 p、q 之间的联系：它们都指向同一数组中的元素。

指针与整数加减运算：设 p 为指向整数数组中某元素的指针，i 为整数，则 p + i 表示指针向后滑动 i 个整数， p - i 表示指针向前滑动 i 个整数。

例一：p 指向 a[0]，则 p + 2 指向 a[2]

例二：p 指向 a[3]，则 p - 2 指向 a[1]

指针与整数加减运算的结果仍为指针类型量，故可赋值

例三：p 指向 a[0]，则 q = p + 2 使得 q 指向 a[2]

指针与整数加减运算规律：以指针指向的目标数据对象类型为单位，而不是以字节为单位。

指针的递增递减运算

例四：p 指向 a[0]，则 p++ 指向 a[1]

例五：p 指向 a[1]，则 --p 指向 a[0]

指针减法运算

两个指针的减法运算结果为其间元素个数

例六： p 指向 a[0]， q 指向 a[2]，q - p 结果为 2

指针关系运算：可以测试两个指针是否相等

例一：设 p、q 为指针，则 p == q 测试两个指针是否指向同一个目标数据对象

空指针：NULL

指针值 0：表示指针不指向任何地方，表示为 NULL

例二：设 p 为指针，则  p = NULL 表示 p 不指向任何目标数据对象

例三（测试指针 p 是否有意义）：if( p != NULL )  等价于 if( p )

使用指针前一定要测试其是否有意义！









